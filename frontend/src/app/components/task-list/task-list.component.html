<div
  class="container mx-auto p-4 max-w-2xl bg-gray-50 rounded-lg shadow-xl mt-8">
  <h1
    class="text-4xl font-extrabold text-center text-blue-800 mb-8 tracking-tight">Lista
    de Tarefas</h1>

  <!-- Formul�rio para Adicionar Nova Tarefa -->
  <div class="mb-8 p-6 bg-white rounded-lg shadow-md border border-blue-200">
    <h2 class="text-2xl font-bold text-blue-700 mb-4">Adicionar Nova Tarefa</h2>
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      <input
        type="text"
        [(ngModel)]="newTaskTitle"
        placeholder="Título da Tarefa"
        class="p-3 border border-blue-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out text-gray-800">
      <input
        type="text"
        [(ngModel)]="newTaskDescription"
        placeholder="Descrição (opcional)"
        class="p-3 border border-blue-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out text-gray-800">
    </div>
    <button
      (click)="addTask()"
      class="w-full mt-4 px-6 py-3 bg-blue-600 text-white font-semibold rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transition duration-300 ease-in-out transform hover:scale-105">
      Adicionar Tarefa
    </button>
  </div>

  <!-- Lista de Tarefas -->
  <div *ngIf="tasks.length > 0; else noTasks" class="space-y-4">
    <h2 class="text-2xl font-bold text-blue-700 mb-4">Minhas Tarefas</h2>
    <div
      *ngFor="let task of tasks"
      class="p-6 bg-white rounded-lg shadow-md border border-gray-200 flex flex-col md:flex-row items-start md:items-center justify-between gap-4 transition-all duration-300 ease-in-out hover:shadow-lg"
      [class.bg-green-50]="task.completed">
      <div *ngIf="editingTask?.id !== task.id"
        class="flex-grow flex items-start md:items-center gap-3">
        <input
          type="checkbox"
          [checked]="task.completed"
          (change)="toggleCompleted(task)"
          class="form-checkbox h-6 w-6 text-blue-600 rounded focus:ring-blue-500 cursor-pointer flex-shrink-0">
        <div>
          <h3
            class="text-lg font-semibold text-gray-900"
            [class.line-through]="task.completed"
            [class.text-gray-500]="task.completed">
            {{ task.title }}
          </h3>
          <p *ngIf="task.description" class="text-sm text-gray-600"
            [class.line-through]="task.completed">
            {{ task.description }}
          </p>
          <p class="text-xs text-gray-400 mt-1">Criada em: {{ task.created_at |
            date:'dd/MM/yyyy HH:mm' }}</p>
        </div>
      </div>

      <!-- Modo de Edição -->
      <div *ngIf="editingTask?.id === task.id"
        class="flex-grow flex flex-col gap-2 w-full">
        <ng-container *ngIf="editingTask as taskToEdit">
          <input
            type="text"
            [(ngModel)]="taskToEdit.title"
            class="p-2 border border-blue-300 rounded-md w-full text-gray-800">
          <textarea
            [(ngModel)]="taskToEdit.description"
            class="p-2 border border-blue-300 rounded-md w-full text-gray-800"
            rows="2"></textarea>
        </ng-container>
        <div class="flex gap-2 mt-2">
          <button
            (click)="saveEditedTask()"
            class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition duration-200 flex-grow">
            Salvar
          </button>
          <button
            (click)="cancelEdit()"
            class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition duration-200 flex-grow">
            Cancelar
          </button>
        </div>
      </div>

      <!-- Botões de Ação -->
      <div *ngIf="editingTask?.id !== task.id"
        class="flex-shrink-0 flex gap-2 mt-2 md:mt-0">
        <button
          (click)="editTask(task)"
          class="p-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition duration-200 transform hover:scale-105"
          title="Editar Tarefa">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
            viewBox="0 0 20 20" fill="currentColor">
            <path
              d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.38-2.828-2.829z" />
          </svg>
        </button>
        <button
          (click)="deleteTask(task.id)"
          class="p-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition duration-200 transform hover:scale-105"
          title="Excluir Tarefa">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
            viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
              clip-rule="evenodd" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mensagem quando não há tarefas -->
  <ng-template #noTasks>
    <p
      class="text-center text-gray-500 text-xl py-8 bg-white rounded-lg shadow-md border border-gray-200">
      Nenhuma tarefa encontrada. Comece adicionando uma!
    </p>
  </ng-template>
</div>